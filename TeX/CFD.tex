\documentclass[10pt, titlepage]{article}
\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage{color}
\usepackage{amsfonts}
\usepackage{xcolor,graphicx}
\usepackage{geometry}
\usepackage{animate}
\usepackage{listings}
\usepackage{wrapfig}
\usepackage{subcaption}
\usepackage{hyperref}

\usepackage{lipsum}

%Modified from:
%http://mathematica.stackexchange.com/a/83811

\definecolor{listinggray}{gray}{0.9}
\definecolor{graphgray}{gray}{0.7}
\definecolor{blue}{rgb}{0,0,1}
\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{purple}{rgb}{0.5,0,0.5}
\definecolor{orange}{rgb}{1,0.5,0}

% define a custom mathematica language for syntax highlighting
\lstdefinelanguage{myMMA}{
keywords={SetDirectory, ColorData, BarLegend, LegendLabel, Graphics, Gray, Polygon, Import, Do, If, Dimensions, Break, AppendTo, Sqrt, All, Length, ListDensityPlot, ColorFunction, PlotRange, AspectRatio, PlotLegends, ColorFunctionScaling, FrameLabel, PlotLabel, Style, FontSize, Black, ImageSize, Full, Show, Automatic, False, LegendMarkerSize, ToString, $CommandLine, Print, LabelStyle, ListContourPlot, ContourShading, Export, Contours, None, Frame, True},
keywords=[2]{i},
keywordstyle=\color{black},
keywordstyle=[2]\color{mygreen},
commentstyle=\color{gray}, 
stringstyle=\color{purple},
identifierstyle=\color{blue},
sensitive=false,
comment=[l]{(*},
morecomment=[s]{/*}{*/},
morecomment=[l][\color{orange}]{\#!},
morestring=[b]',
morestring=[b]",
breaklines=true,
captionpos=b,
numbers=left,
literate={->}{$\rightarrow{}$}{1}
}


\title{Computational Fluid Dynamics}
\author{Brady Metherall \and 100516905}
\date{Monday April 4, 2016}

\begin{document}
\newgeometry{margin=1in}
\maketitle
\setlength\parindent{0pt}
\lstset{language=myMMA}

\listoffigures

\section{Introduction}

\begin{wrapfigure}{R}{0.5\textwidth}
\centering
\animategraphics[loop, width = 0.5\textwidth, autoplay]{12}{Airfoil_Animation_Turb/Square_Cylinder}{0050}{0074}
\caption[Pitching Airfoil Animation]{Look at how neat that is!}
\label{fig:airfoilanimation}
\end{wrapfigure}

\lipsum[1-4]

\section{Theory}

\subsection{Non-Turbulent Flow Equations}
\begin{align*}
\frac{D\bf{u}}{Dt} &= \frac{\partial \bf{u}}{\partial t} + \left( \bf{u} \cdot \nabla \right) \bf{u}
\end{align*}

Euler's Equations
\begin{equation}
\label{euler}
\begin{aligned}
\frac{\partial \bf{u}}{\partial t} + \left( \bf{u} \cdot \nabla \right) \bf{u} &= - \frac{1}{\rho} \nabla p + \bf{g} \\
\nabla \cdot \bf{u} &= 0
\end{aligned}
\end{equation}

Cauchy's Equation
\begin{align}
\rho \left( \frac{\partial \bf{u}}{\partial t} + \left( \bf{u} \cdot \nabla \right) \bf{u} \right) &= \nabla \cdot \bf{T} + \rho \bf{g}
\end{align}

Navier-Stokes Equation
\begin{equation}
\begin{aligned}
\rho \left( \frac{\partial \bf{u}}{\partial t} + \left( \bf{u} \cdot \nabla \right) \bf{u} \right) &= - \nabla p + \mu \nabla^2 \bf{u} + \rho \bf{g} \\
\frac{\partial \bf{u}}{\partial t} + \left( \bf{u} \cdot \nabla \right) \bf{u} &= - \frac{1}{\rho} \nabla p + \nu \nabla^2 \bf{u} + \bf{g} \\
\sum_j \frac{\partial u_i}{\partial t} + u_j \frac{\partial u_i}{\partial x_j} &= \sum_j  -\frac{1}{\rho} \frac{\partial p}{\partial x_i} + \nu \frac{\partial^2 u_i}{\partial x_j^2} + g_i
\end{aligned}
\end{equation}

\subsection{Reynolds-Averaged Navier-Stokes (RANS)}

\begin{align*}
\mu = \mu_{dyn} + \mu_{turb}
\end{align*}

\subsection{Spalart-Allmaras (SA) Turbulent Model}\label{subsec:saturb}
A one equation turbulent model.
\begin{align}
\mu_{turb} = \rho \hat{\nu} f_{v1}; \qquad f_{v1} = \frac{\chi^3}{\chi^3+c_{v1}^3}; \qquad \chi = \frac{\hat{\nu}}{\nu}; \qquad \nu = \frac{\mu_{dyn}}{\rho}
\label{eq:saeq}
\end{align}
Assuming the flow is incompressible, and the diffusivity is constant, $\hat{\nu}$ is obtained by solving the convection-diffusion equation,
\begin{align}
\frac{\partial \hat{\nu}}{\partial t} = D \nabla^2 \hat{\nu} - \overline{\bf{u}} \nabla \hat{\nu},
\end{align}
where $D$ is the diffusivity, and $\overline{\bf{u}}$ is the average flow velocity.

\section{Stanford University Unstructured ($SU^2$) Code}
$c_{v1} = 7.1$ for \eqref{eq:saeq} \\

Uses the SA turbulence model (\ref{subsec:saturb}) as well as the Menter Shear Stress Transport (SST) Model, however the SST model was not used in any of the simulations.

\lipsum[1-2]

\subsection{Mesh}

\begin{wrapfigure}{R}{0.5\textwidth}
\centering
\includegraphics[width = 0.5\textwidth]{Pictures/AirfoilMesh}
\caption[Mesh of an Airfoil]{Mesh of an airfoil \cite{mesh}.}
\label{fig:airfoilmesh}
\end{wrapfigure}

\lipsum[1-2]

\subsection{Numerics}

Typically a particular node within the mesh will be surrounded by six triangular cells. Using the centroids of the cells, as well as the midpoints of the edges, we can construct a hexagonal region, $\Omega_i$. This leads to the discretized form of our PDE:
\begin{equation*}
\int_{\Omega_i} \frac{\partial \bf{u}}{\partial t} d\Omega + R_i(\bf{u}) = 0
\end{equation*}
where $R_i(\bf{u})$ is the residual.

\section{Scripting and Automation}
\lipsum[1-2]

\begin{figure}[p]
\lstinputlisting[breaklines=true, label=makecontour]{MakeContour.m}
\caption[Automated Wolfram Script]{The Wolfram script used to generate Figure \ref{fig:airfoilanimation}. Syntax highlighting modified from \cite{syntax}.}
\label{script}
\end{figure}

\section{Results}
\lipsum[1-2]

\subsection{Steady Flow Around a Static Cylinder}
\lipsum[1-2]

\begin{figure}[htbp]
\begin{subfigure}{0.5\linewidth}
  \centering
  \includegraphics[width=\textwidth]{./Pictures/Static_Cylinder}
  \caption{Euler}
  \label{fig:staticeuler}
\end{subfigure}
\begin{subfigure}{0.5\linewidth}
  \centering
  \includegraphics[width=\textwidth]{./Pictures/Static_Cylinder_NS}
  \caption{NS}
  \label{fig:staticNS}
\end{subfigure} \\
\begin{subfigure}{0.5\linewidth}
 \centering
 \includegraphics[width=\textwidth]{./Pictures/Static_Cylinder_Boundary}
 \caption{No-slip condition.}
 \label{fig:eulerboundary}
\end{subfigure}
\begin{subfigure}{0.5\linewidth}
 \centering
 \includegraphics[width=\textwidth]{./Pictures/Static_Cylinder_Boundary_NS}
 \caption{The boundary layer that forms due to a viscous fluid.}
 \label{fig:nsboundary}
\end{subfigure}
\caption[Static Cylinder]{Static Cylinders}
\label{fig:static}
\end{figure}

%\begin{figure}[htb]
%\centering
%\includegraphics[width=0.6\textwidth]{./Pictures/Static_Cylinder_NS_Boundary}
%\caption[Boundary Layer Due to Viscous Flow]{The boundary layer that forms due to a viscous fluid.}
%\label{fig:boundary}
%\end{figure}

\subsection{Turbulent Cylinder -- Vortex Shedding}

The equation \eqref{euler} is interesting.

\begin{figure}[htb]
\centering
\animategraphics[label=vortex, loop, width = \textwidth, autoplay]{12}{Vortex_Animation/Vortex_Shedding}{00}{26}
\caption[Vortex Shedding Animation]{Neat! The full video can be found at \url{https://youtu.be/Zh5lWMpsCJg}}
\label{vortexanimation}
\end{figure}

\lipsum[1-2]

\begin{figure}
\begin{subfigure}{\linewidth}
  \centering
  \includegraphics[height=0.17\paperheight]{./Pictures/Vortex_Shedding1600}
  \caption{$t = 0$}
\end{subfigure} \\
\begin{subfigure}{\textwidth}
  \centering
  \includegraphics[height=0.17\paperheight]{./Pictures/Vortex_Shedding1628}
  \caption{$t = \frac{1}{4}T$}
\end{subfigure} \\
\begin{subfigure}{\linewidth}
  \centering
  \includegraphics[height=0.17\paperheight]{./Pictures/Vortex_Shedding1656}
  \caption{$t = \frac{1}{2}T$}
\end{subfigure} \\
\begin{subfigure}{\textwidth}
  \centering
  \includegraphics[height=0.17\paperheight]{./Pictures/Vortex_Shedding1684}
  \caption{$t = \frac{3}{4}T$}
\end{subfigure}
\caption[Vortex Shedding at $\frac{1}{4}T$ increments]{Vortex shedding!}
\label{fig:vortexshedding}
\end{figure}

\subsection{Airfoil}
\lipsum[4-7]

\begin{figure}[ht]
\centering
\includegraphics[width=0.75\textwidth]{./Pictures/Airfoil_10_0}
\caption[Airfoil, No Turbulence]{Airfoil no turbulence.}
\label{airfoil}
\end{figure}

\section{Conclusion}

\lipsum[5-7]

\newpage
\begin{thebibliography}{9}

%\bibitem{taketani} %Scale / range
%Taketani, Mituo and Nakamura, Seitaro and Sasaki, Muneo,
%\emph{On the Method of the Theory of Nuclear Forces},
%Progress of Theoretical Physics \textbf{6}, 581-586 (1951).

\bibitem{syntax} %Mathematica syntax highlighting
Belisarius (http://mathematica.stackexchange.com/users/29581/belisarius), Highlighting Mathematica code in \LaTeX document, URL: http://mathematica.stackexchange.com/a/83811

\bibitem{mesh}
https://github.com/su2code/SU2/wiki/Quick-Start

\bibitem{su2main}
Francisco Palacios, Juan Alonso, Karthikeyan Duraisamy, Michael Colonno, Jason Hicken, Aniket Aranake, Alejandro Campos, Sean Copeland, Thomas Economon, Amrita Lonkar, Trent Lukaczyk, and Thomas Taylor, \\
\emph{Stanford University Unstructured ($SU^2$): An open-source integrated computational environment for multi-physics simulation and design}, \\
51st AIAA Aerospace Sciences Meeting including the New Horizons Forum and Aerospace Exposition. 



\end{thebibliography}

\end{document}